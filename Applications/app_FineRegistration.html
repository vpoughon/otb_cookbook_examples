

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>FineRegistration &mdash; Orfeo ToolBox 6.7.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/otb_theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="StereoFramework" href="app_StereoFramework.html" />
    <link rel="prev" title="DisparityMapToElevationMap" href="app_DisparityMapToElevationMap.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo-with-text.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                6.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Monteverdi.html">Monteverdi</a></li>
</ul>
<p class="caption"><span class="caption-text">Applications</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../CliInterface.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GraphicalInterface.html">Graphical interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PythonAPI.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../QGISInterface.html">QGIS interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Recipes.html">Recipes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../Applications.html">All Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Image_Manipulation.html">Image Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Feature_Extraction.html">Feature Extraction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="Stereo.html">Stereo</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="app_BlockMatching.html">BlockMatching</a></li>
<li class="toctree-l3"><a class="reference internal" href="app_DisparityMapToElevationMap.html">DisparityMapToElevationMap</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">FineRegistration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#limitations">Limitations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="app_StereoFramework.html">StereoFramework</a></li>
<li class="toctree-l3"><a class="reference internal" href="app_StereoRectificationGridGenerator.html">StereoRectificationGridGenerator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Geometry.html">Geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="Learning.html">Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="SAR.html">SAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="Segmentation.html">Segmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Vector_Data_Manipulation.html">Vector Data Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Image_Filtering.html">Image Filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="Hyperspectral.html">Hyperspectral</a></li>
<li class="toctree-l2"><a class="reference internal" href="Change_Detection.html">Change Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="Calibration.html">Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="Deprecated.html">Deprecated</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Advanced use</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../EnvironmentVariables.html">Environment variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ExtendedFilenames.html">Extended filenames</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CompilingOTBFromSource.html">Compiling OTB from source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../C++.html">C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Contributors.html">Contributors</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Orfeo ToolBox</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../Applications.html">All Applications</a> &raquo;</li>
        
          <li><a href="Stereo.html">Stereo</a> &raquo;</li>
        
      <li>FineRegistration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://gitlab.orfeo-toolbox.org/orfeotoolbox/OTB/blob/develop/Documentation/Cookbook/rst/Applications/app_FineRegistration.rst" class="fa fa-gitlab"> Edit on GitLab</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="fineregistration">
<span id="id1"></span><h1>FineRegistration<a class="headerlink" href="#fineregistration" title="Permalink to this headline">¶</a></h1>
<p>Estimate disparity map between two images.</p>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This application computes a disparity map between two images that correspond to the same scene. It is intended for case where small misregistration between images should be estimated and fixed. The search is performed in 2D.</p>
<p>The algorithm uses an iterative approach to estimate a best match between local patches. The typical use case is registration betwween similar bands, or between two acquisitions. The output image contains X and Y offsets, as well as the metric value. A sub-pixel accuracy can be expected. The input images should have the same size and same physical space.</p>
</div>
<div class="section" id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<p><strong>Reference Image</strong> <code class="code docutils literal notranslate"><span class="pre">-ref</span> <span class="pre">image</span></code> <em>Mandatory</em> <br />
The reference image.</p>
<p><strong>Secondary Image</strong> <code class="code docutils literal notranslate"><span class="pre">-sec</span> <span class="pre">image</span></code> <em>Mandatory</em> <br />
The secondary image.</p>
<p><strong>Output Image</strong> <code class="code docutils literal notranslate"><span class="pre">-out</span> <span class="pre">image</span> <span class="pre">[dtype]</span></code> <em>Mandatory</em> <br />
The output image contains 3 bands, for X offset, Y offset and the metric value. It may contain a 4th one with the validity mask (if used).</p>
<p><strong>Exploration Radius X</strong> <code class="code docutils literal notranslate"><span class="pre">-erx</span> <span class="pre">int</span></code> <em>Mandatory</em> <br />
The exploration radius along x (in pixels)</p>
<p><strong>Exploration Radius Y</strong> <code class="code docutils literal notranslate"><span class="pre">-ery</span> <span class="pre">int</span></code> <em>Mandatory</em> <br />
The exploration radius along y (in pixels)</p>
<p><strong>Metric Radius X</strong> <code class="code docutils literal notranslate"><span class="pre">-mrx</span> <span class="pre">int</span></code> <em>Mandatory</em> <br />
Radius along x (in pixels) of the metric computation window</p>
<p><strong>Metric Radius Y</strong> <code class="code docutils literal notranslate"><span class="pre">-mry</span> <span class="pre">int</span></code> <em>Mandatory</em> <br />
Radius along y (in pixels) of the metric computation window</p>
<p><strong>Image To Warp</strong> <code class="code docutils literal notranslate"><span class="pre">-w</span> <span class="pre">image</span></code> <br />
The image to warp after disparity estimation is completed.</p>
<p><strong>Output Warped Image</strong> <code class="code docutils literal notranslate"><span class="pre">-wo</span> <span class="pre">image</span> <span class="pre">[dtype]</span></code> <br />
The output warped image</p>
<p><strong>Coarse Offset X</strong> <code class="code docutils literal notranslate"><span class="pre">-cox</span> <span class="pre">float</span></code> <em>Default value: 0</em> <br />
Coarse offset along x (in physical space) between the two images, used as an initial offset for all pixels.</p>
<p><strong>Coarse Offset Y</strong> <code class="code docutils literal notranslate"><span class="pre">-coy</span> <span class="pre">float</span></code> <em>Default value: 0</em> <br />
Coarse offset along y (in physical space) between the two images, used as an initial offset for all pixels.</p>
<p><strong>Sub-Sampling Rate X</strong> <code class="code docutils literal notranslate"><span class="pre">-ssrx</span> <span class="pre">float</span></code> <em>Default value: 1</em> <br />
Generates a result at a coarser resolution with a given sub-sampling rate along X</p>
<p><strong>Sub-Sampling Rate Y</strong> <code class="code docutils literal notranslate"><span class="pre">-ssry</span> <span class="pre">float</span></code> <em>Default value: 1</em> <br />
Generates a result at a coarser resolution with a given sub-sampling rate along Y</p>
<p><strong>Reference Gaussian Smoothing X</strong> <code class="code docutils literal notranslate"><span class="pre">-rgsx</span> <span class="pre">float</span></code> <br />
Performs a gaussian smoothing of the reference image. Parameter is gaussian sigma (in pixels) in X direction.</p>
<p><strong>Reference Gaussian Smoothing Y</strong> <code class="code docutils literal notranslate"><span class="pre">-rgsy</span> <span class="pre">float</span></code> <br />
Performs a gaussian smoothing of the reference image. Parameter is gaussian sigma (in pixels) in Y direction.</p>
<p><strong>Secondary Gaussian Smoothing X</strong> <code class="code docutils literal notranslate"><span class="pre">-sgsx</span> <span class="pre">float</span></code> <br />
Performs a gaussian smoothing of the secondary image. Parameter is gaussian sigma (in pixels) in X direction.</p>
<p><strong>Secondary Gaussian Smoothing Y</strong> <code class="code docutils literal notranslate"><span class="pre">-sgsy</span> <span class="pre">float</span></code> <br />
Performs a gaussian smoothing of the secondary image. Parameter is gaussian sigma (in pixels) in Y direction.</p>
<p><strong>Metric</strong> <code class="code docutils literal notranslate"><span class="pre">-m</span> <span class="pre">string</span></code> <br />
Choose the metric used for block matching. Available metrics are cross-correlation (CC), cross-correlation with subtracted mean (CCSM), mean-square difference (MSD), mean reciprocal square difference (MRSD) and mutual information (MI). Default is cross-correlation</p>
<p><strong>SubPixelAccuracy</strong> <code class="code docutils literal notranslate"><span class="pre">-spa</span> <span class="pre">float</span></code> <em>Default value: 0.01</em> <br />
Metric extrema location will be refined up to the given accuracy. Default is 0.01</p>
<p><strong>ConvergenceAccuracy</strong> <code class="code docutils literal notranslate"><span class="pre">-cva</span> <span class="pre">float</span></code> <em>Default value: 0.01</em> <br />
Metric extrema will be refined up to the given accuracy. Default is 0.01</p>
<p><strong>Validity Mask Lower Threshold</strong> <code class="code docutils literal notranslate"><span class="pre">-vmlt</span> <span class="pre">float</span></code> <br />
Lower threshold to compute the validity mask. This mask will be the 4th output band.</p>
<p><strong>Validity Mask Upper Threshold</strong> <code class="code docutils literal notranslate"><span class="pre">-vmut</span> <span class="pre">float</span></code> <br />
Upper threshold to obtain a validity mask. This mask will be the 4th output band.</p>
<p><strong>Available RAM (MB)</strong> <code class="code docutils literal notranslate"><span class="pre">-ram</span> <span class="pre">int</span></code> <em>Default value: 256</em> <br />
Available memory for processing (in MB).</p>
<p><strong>Load parameters from XML</strong> <code class="code docutils literal notranslate"><span class="pre">-inxml</span> <span class="pre">filename.xml</span></code> <br />
Load application parameters from an XML file.</p>
<p><strong>Save parameters to XML</strong> <code class="code docutils literal notranslate"><span class="pre">-outxml</span> <span class="pre">filename.xml</span></code> <br />
Save application parameters to an XML file.</p>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>From the command-line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>otbcli_FineRegistration -ref StereoFixed.png -sec StereoMoving.png -out FineRegistration.tif -erx <span class="m">2</span> -ery <span class="m">2</span> -mrx <span class="m">3</span> -mry <span class="m">3</span> -w StereoMoving.png -wo StereoMoving_FineRegistered.png
</pre></div>
</div>
<p>From Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">otbApplication</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">otbApplication</span><span class="o">.</span><span class="n">Registry</span><span class="o">.</span><span class="n">CreateApplication</span><span class="p">(</span><span class="s2">&quot;FineRegistration&quot;</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">SetParameterString</span><span class="p">(</span><span class="s2">&quot;ref&quot;</span><span class="p">,</span> <span class="s2">&quot;StereoFixed.png&quot;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">SetParameterString</span><span class="p">(</span><span class="s2">&quot;sec&quot;</span><span class="p">,</span> <span class="s2">&quot;StereoMoving.png&quot;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">SetParameterString</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">,</span> <span class="s2">&quot;FineRegistration.tif&quot;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">SetParameterInt</span><span class="p">(</span><span class="s2">&quot;erx&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">SetParameterInt</span><span class="p">(</span><span class="s2">&quot;ery&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">SetParameterInt</span><span class="p">(</span><span class="s2">&quot;mrx&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">SetParameterInt</span><span class="p">(</span><span class="s2">&quot;mry&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">SetParameterString</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;StereoMoving.png&quot;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">SetParameterString</span><span class="p">(</span><span class="s2">&quot;wo&quot;</span><span class="p">,</span> <span class="s2">&quot;StereoMoving_FineRegistered.png&quot;</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">ExecuteAndWriteOutput</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">¶</a></h2>
<p>If the ‘warp’ option is activated, the pipeline will be executed twice.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="app_StereoFramework.html" class="btn btn-neutral float-right" title="StereoFramework" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="app_DisparityMapToElevationMap.html" class="btn btn-neutral" title="DisparityMapToElevationMap" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019 CNES. The OTB CookBook is licensed under a Creative Commons Attribution-ShareAlike 4.0 International license (CC-BY-SA).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/js/versions.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>